中文医疗实体识别模型
模型名称: macbert_crf
设备: cpu

1. 数据准备
数据已划分完成

2. 开始训练模型
2026-01-11 00:02:22.225731: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2026-01-11 00:02:24.728683: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.

Epoch 1/10
--------------------------------------------------
训练: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [34:01<00:00,  5.10s/it]
训练损失: 64.8244
评估: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:51<00:00,  2.04s/it]
实体识别评估指标
==================================================
中药功效:
  精确率: 0.8299
  召回率: 0.8450
  F1值: 0.8373
  TP: 278, FP: 57, FN: 51
------------------------------
人群:
  精确率: 0.7143
  召回率: 0.8333
  F1值: 0.7692
  TP: 85, FP: 34, FN: 17
------------------------------
疾病:
  精确率: 0.4235
  召回率: 0.5714
  F1值: 0.4865
  TP: 36, FP: 49, FN: 27
------------------------------
疾病分组:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 22
------------------------------
症状:
  精确率: 0.7379
  召回率: 0.7691
  F1值: 0.7532
  TP: 473, FP: 168, FN: 142
------------------------------
药品:
  精确率: 0.9353
  召回率: 0.9698
  F1值: 0.9522
  TP: 289, FP: 20, FN: 9
------------------------------
药品分组:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 1
------------------------------
药物剂型:
  精确率: 0.6761
  召回率: 0.8727
  F1值: 0.7619
  TP: 96, FP: 46, FN: 14
------------------------------
药物性味:
  精确率: 0.8714
  召回率: 0.8414
  F1值: 0.8561
  TP: 122, FP: 18, FN: 23
------------------------------
药物成分:
  精确率: 0.9662
  召回率: 0.9577
  F1值: 0.9619
  TP: 1970, FP: 69, FN: 87
------------------------------
证候:
  精确率: 0.5353
  召回率: 0.5759
  F1值: 0.5549
  TP: 91, FP: 79, FN: 67
------------------------------
食物:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 1
------------------------------
食物分组:
  精确率: 0.7826
  召回率: 0.6923
  F1值: 0.7347
  TP: 18, FP: 5, FN: 8
------------------------------
微平均:
  精确率: 0.8639
  召回率: 0.8806
  F1值: 0.8721
------------------------------
宏平均:
  精确率: 0.5748
  召回率: 0.6099
  F1值: 0.5898
==================================================
保存最佳模型到 C:\Users\Lenovo\Desktop\AAA研究生存档\课程学习\自然语言处理\code\medical_ner\output\models\macbert_crf_best_model.pt

Epoch 2/10
--------------------------------------------------
训练: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [33:46<00:00,  5.07s/it] 
训练损失: 24.3096
评估: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:51<00:00,  2.05s/it] 
实体识别评估指标
==================================================
中药功效:
  精确率: 0.8478
  召回率: 0.8632
  F1值: 0.8554
  TP: 284, FP: 51, FN: 45
------------------------------
人群:
  精确率: 0.7190
  召回率: 0.8529
  F1值: 0.7803
  TP: 87, FP: 34, FN: 15
------------------------------
疾病:
  精确率: 0.3864
  召回率: 0.8095
  F1值: 0.5231
  TP: 51, FP: 81, FN: 12
------------------------------
疾病分组:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 5, FN: 22
------------------------------
症状:
  精确率: 0.7504
  召回率: 0.7967
  F1值: 0.7729
  TP: 490, FP: 163, FN: 125
------------------------------
药品:
  精确率: 0.9474
  召回率: 0.9664
  F1值: 0.9568
  TP: 288, FP: 16, FN: 10
------------------------------
药品分组:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 1
------------------------------
药物剂型:
  精确率: 0.7526
  召回率: 0.6636
  F1值: 0.7053
  TP: 73, FP: 24, FN: 37
------------------------------
药物性味:
  精确率: 0.8767
  召回率: 0.8828
  F1值: 0.8797
  TP: 128, FP: 18, FN: 17
------------------------------
药物成分:
  精确率: 0.9751
  召回率: 0.9718
  F1值: 0.9735
  TP: 1999, FP: 51, FN: 58
------------------------------
证候:
  精确率: 0.6171
  召回率: 0.6835
  F1值: 0.6486
  TP: 108, FP: 67, FN: 50
------------------------------
食物:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 1
------------------------------
食物分组:
  精确率: 0.7037
  召回率: 0.7308
  F1值: 0.7170
  TP: 19, FP: 8, FN: 7
------------------------------
微平均:
  精确率: 0.8719
  召回率: 0.8981
  F1值: 0.8848
------------------------------
宏平均:
  精确率: 0.5828
  召回率: 0.6324
  F1值: 0.6010
==================================================
保存最佳模型到 C:\Users\Lenovo\Desktop\AAA研究生存档\课程学习\自然语言处理\code\medical_ner\output\models\macbert_crf_best_model.pt

Epoch 3/10
--------------------------------------------------
训练: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [34:02<00:00,  5.11s/it] 
训练损失: 20.6329
评估: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:51<00:00,  2.05s/it] 
实体识别评估指标
==================================================
中药功效:
  精确率: 0.8675
  召回率: 0.8359
  F1值: 0.8514
  TP: 275, FP: 42, FN: 54
------------------------------
人群:
  精确率: 0.7909
  召回率: 0.8529
  F1值: 0.8208
  TP: 87, FP: 23, FN: 15
------------------------------
疾病:
  精确率: 0.4000
  召回率: 0.6667
  F1值: 0.5000
  TP: 42, FP: 63, FN: 21
------------------------------
疾病分组:
  精确率: 0.1111
  召回率: 0.0909
  F1值: 0.1000
  TP: 2, FP: 16, FN: 20
------------------------------
症状:
  精确率: 0.7311
  召回率: 0.8000
  F1值: 0.7640
  TP: 492, FP: 181, FN: 123
------------------------------
药品:
  精确率: 0.9565
  召回率: 0.9597
  F1值: 0.9581
  TP: 286, FP: 13, FN: 12
------------------------------
药品分组:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 1
------------------------------
药物剂型:
  精确率: 0.7016
  召回率: 0.7909
  F1值: 0.7436
  TP: 87, FP: 37, FN: 23
------------------------------
药物性味:
  精确率: 0.8844
  召回率: 0.8966
  F1值: 0.8904
  TP: 130, FP: 17, FN: 15
------------------------------
药物成分:
  精确率: 0.9742
  召回率: 0.9742
  F1值: 0.9742
  TP: 2004, FP: 53, FN: 53
------------------------------
证候:
  精确率: 0.5906
  召回率: 0.6392
  F1值: 0.6140
  TP: 101, FP: 70, FN: 57
------------------------------
食物:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 1
------------------------------
食物分组:
  精确率: 0.7407
  召回率: 0.7692
  F1值: 0.7547
  TP: 20, FP: 7, FN: 6
------------------------------
微平均:
  精确率: 0.8710
  召回率: 0.8979
  F1值: 0.8843
------------------------------
宏平均:
  精确率: 0.5961
  召回率: 0.6366
  F1值: 0.6132
==================================================

Epoch 4/10
--------------------------------------------------
训练: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [33:41<00:00,  5.05s/it] 
训练损失: 17.7902
评估: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:51<00:00,  2.04s/it] 
实体识别评估指标
==================================================
中药功效:
  精确率: 0.8580
  召回率: 0.8632
  F1值: 0.8606
  TP: 284, FP: 47, FN: 45
------------------------------
人群:
  精确率: 0.7132
  召回率: 0.9020
  F1值: 0.7965
  TP: 92, FP: 37, FN: 10
------------------------------
疾病:
  精确率: 0.4167
  召回率: 0.4762
  F1值: 0.4444
  TP: 30, FP: 42, FN: 33
------------------------------
疾病分组:
  精确率: 0.1569
  召回率: 0.3636
  F1值: 0.2192
  TP: 8, FP: 43, FN: 14
------------------------------
症状:
  精确率: 0.7318
  召回率: 0.8163
  F1值: 0.7717
  TP: 502, FP: 184, FN: 113
------------------------------
药品:
  精确率: 0.9443
  召回率: 0.9664
  F1值: 0.9552
  TP: 288, FP: 17, FN: 10
------------------------------
药品分组:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 1
------------------------------
药物剂型:
  精确率: 0.6398
  召回率: 0.9364
  F1值: 0.7601
  TP: 103, FP: 58, FN: 7
------------------------------
药物性味:
  精确率: 0.8543
  召回率: 0.8897
  F1值: 0.8716
  TP: 129, FP: 22, FN: 16
------------------------------
药物成分:
  精确率: 0.9772
  召回率: 0.9776
  F1值: 0.9774
  TP: 2011, FP: 47, FN: 46
------------------------------
证候:
  精确率: 0.5361
  召回率: 0.6582
  F1值: 0.5909
  TP: 104, FP: 90, FN: 54
------------------------------
食物:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 1
------------------------------
食物分组:
  精确率: 0.7037
  召回率: 0.7308
  F1值: 0.7170
  TP: 19, FP: 8, FN: 7
------------------------------
微平均:
  精确率: 0.8571
  召回率: 0.9091
  F1值: 0.8824
------------------------------
宏平均:
  精确率: 0.5794
  召回率: 0.6600
  F1值: 0.6127
==================================================

Epoch 5/10
--------------------------------------------------
训练: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [33:42<00:00,  5.06s/it] 
训练损失: 15.8315
评估: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:51<00:00,  2.06s/it] 
实体识别评估指标
==================================================
中药功效:
  精确率: 0.8754
  召回率: 0.8116
  F1值: 0.8423
  TP: 267, FP: 38, FN: 62
------------------------------
人群:
  精确率: 0.7759
  召回率: 0.8824
  F1值: 0.8257
  TP: 90, FP: 26, FN: 12
------------------------------
疾病:
  精确率: 0.4875
  召回率: 0.6190
  F1值: 0.5455
  TP: 39, FP: 41, FN: 24
------------------------------
疾病分组:
  精确率: 0.2857
  召回率: 0.1818
  F1值: 0.2222
  TP: 4, FP: 10, FN: 18
------------------------------
症状:
  精确率: 0.7684
  召回率: 0.7984
  F1值: 0.7831
  TP: 491, FP: 148, FN: 124
------------------------------
药品:
  精确率: 0.9567
  召回率: 0.9631
  F1值: 0.9599
  TP: 287, FP: 13, FN: 11
------------------------------
药品分组:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 1
------------------------------
药物剂型:
  精确率: 0.6978
  召回率: 0.8818
  F1值: 0.7791
  TP: 97, FP: 42, FN: 13
------------------------------
药物性味:
  精确率: 0.8811
  召回率: 0.8690
  F1值: 0.8750
  TP: 126, FP: 17, FN: 19
------------------------------
药物成分:
  精确率: 0.9724
  召回率: 0.9776
  F1值: 0.9750
  TP: 2011, FP: 57, FN: 46
------------------------------
证候:
  精确率: 0.6036
  召回率: 0.6456
  F1值: 0.6239
  TP: 102, FP: 67, FN: 56
------------------------------
食物:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 1
------------------------------
食物分组:
  精确率: 0.7407
  召回率: 0.7692
  F1值: 0.7547
  TP: 20, FP: 7, FN: 6
------------------------------
微平均:
  精确率: 0.8835
  召回率: 0.8999
  F1值: 0.8916
------------------------------
宏平均:
  精确率: 0.6189
  召回率: 0.6461
  F1值: 0.6297
==================================================
保存最佳模型到 C:\Users\Lenovo\Desktop\AAA研究生存档\课程学习\自然语言处理\code\medical_ner\output\models\macbert_crf_best_model.pt

Epoch 6/10
--------------------------------------------------
训练: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [33:42<00:00,  5.06s/it] 
训练损失: 14.3577
评估: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:55<00:00,  2.22s/it] 
实体识别评估指标
==================================================
中药功效:
  精确率: 0.8634
  召回率: 0.8450
  F1值: 0.8541
  TP: 278, FP: 44, FN: 51
------------------------------
人群:
  精确率: 0.7542
  召回率: 0.8725
  F1值: 0.8091
  TP: 89, FP: 29, FN: 13
------------------------------
疾病:
  精确率: 0.4409
  召回率: 0.6508
  F1值: 0.5256
  TP: 41, FP: 52, FN: 22
------------------------------
疾病分组:
  精确率: 0.3500
  召回率: 0.3182
  F1值: 0.3333
  TP: 7, FP: 13, FN: 15
------------------------------
症状:
  精确率: 0.7432
  召回率: 0.8000
  F1值: 0.7706
  TP: 492, FP: 170, FN: 123
------------------------------
药品:
  精确率: 0.9567
  召回率: 0.9631
  F1值: 0.9599
  TP: 287, FP: 13, FN: 11
------------------------------
药品分组:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 1
------------------------------
药物剂型:
  精确率: 0.6803
  召回率: 0.9091
  F1值: 0.7782
  TP: 100, FP: 47, FN: 10
------------------------------
药物性味:
  精确率: 0.8639
  召回率: 0.8759
  F1值: 0.8699
  TP: 127, FP: 20, FN: 18
------------------------------
药物成分:
  精确率: 0.9743
  召回率: 0.9767
  F1值: 0.9755
  TP: 2009, FP: 53, FN: 48
------------------------------
证候:
  精确率: 0.5941
  召回率: 0.6392
  F1值: 0.6159
  TP: 101, FP: 69, FN: 57
------------------------------
食物:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 1
------------------------------
食物分组:
  精确率: 0.7407
  召回率: 0.7692
  F1值: 0.7547
  TP: 20, FP: 7, FN: 6
------------------------------
微平均:
  精确率: 0.8729
  召回率: 0.9043
  F1值: 0.8883
------------------------------
宏平均:
  精确率: 0.6124
  召回率: 0.6631
  F1值: 0.6344
==================================================

Epoch 7/10
--------------------------------------------------
训练: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [33:34<00:00,  5.04s/it] 
训练损失: 12.7994
评估: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:50<00:00,  2.04s/it] 
实体识别评估指标
==================================================
中药功效:
  精确率: 0.8746
  召回率: 0.8055
  F1值: 0.8386
  TP: 265, FP: 38, FN: 64
------------------------------
人群:
  精确率: 0.7607
  召回率: 0.8725
  F1值: 0.8128
  TP: 89, FP: 28, FN: 13
------------------------------
疾病:
  精确率: 0.4941
  召回率: 0.6667
  F1值: 0.5676
  TP: 42, FP: 43, FN: 21
------------------------------
疾病分组:
  精确率: 0.3571
  召回率: 0.2273
  F1值: 0.2778
  TP: 5, FP: 9, FN: 17
------------------------------
症状:
  精确率: 0.7586
  召回率: 0.7919
  F1值: 0.7749
  TP: 487, FP: 155, FN: 128
------------------------------
药品:
  精确率: 0.9439
  召回率: 0.9597
  F1值: 0.9517
  TP: 286, FP: 17, FN: 12
------------------------------
药品分组:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 1
------------------------------
药物剂型:
  精确率: 0.6944
  召回率: 0.9091
  F1值: 0.7874
  TP: 100, FP: 44, FN: 10
------------------------------
药物性味:
  精确率: 0.8828
  召回率: 0.8828
  F1值: 0.8828
  TP: 128, FP: 17, FN: 17
------------------------------
药物成分:
  精确率: 0.9767
  召回率: 0.9772
  F1值: 0.9769
  TP: 2010, FP: 48, FN: 47
------------------------------
证候:
  精确率: 0.6108
  召回率: 0.6456
  F1值: 0.6277
  TP: 102, FP: 65, FN: 56
------------------------------
食物:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 1
------------------------------
食物分组:
  精确率: 0.6429
  召回率: 0.6923
  F1值: 0.6667
  TP: 18, FP: 10, FN: 8
------------------------------
微平均:
  精确率: 0.8817
  召回率: 0.8994
  F1值: 0.8905
------------------------------
宏平均:
  精确率: 0.6151
  召回率: 0.6485
  F1值: 0.6281
==================================================

Epoch 8/10
--------------------------------------------------
训练: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [33:42<00:00,  5.06s/it] 
训练损失: 11.4490
评估: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:51<00:00,  2.05s/it] 
实体识别评估指标
==================================================
中药功效:
  精确率: 0.8839
  召回率: 0.8328
  F1值: 0.8576
  TP: 274, FP: 36, FN: 55
------------------------------
人群:
  精确率: 0.7333
  召回率: 0.8627
  F1值: 0.7928
  TP: 88, FP: 32, FN: 14
------------------------------
疾病:
  精确率: 0.4583
  召回率: 0.6984
  F1值: 0.5535
  TP: 44, FP: 52, FN: 19
------------------------------
疾病分组:
  精确率: 0.2778
  召回率: 0.2273
  F1值: 0.2500
  TP: 5, FP: 13, FN: 17
------------------------------
症状:
  精确率: 0.7402
  召回率: 0.7967
  F1值: 0.7674
  TP: 490, FP: 172, FN: 125
------------------------------
药品:
  精确率: 0.9410
  召回率: 0.9631
  F1值: 0.9519
  TP: 287, FP: 18, FN: 11
------------------------------
药品分组:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 1
------------------------------
药物剂型:
  精确率: 0.6871
  召回率: 0.9182
  F1值: 0.7860
  TP: 101, FP: 46, FN: 9
------------------------------
药物性味:
  精确率: 0.8581
  召回率: 0.8759
  F1值: 0.8669
  TP: 127, FP: 21, FN: 18
------------------------------
药物成分:
  精确率: 0.9772
  召回率: 0.9801
  F1值: 0.9786
  TP: 2016, FP: 47, FN: 41
------------------------------
证候:
  精确率: 0.5747
  召回率: 0.6329
  F1值: 0.6024
  TP: 100, FP: 74, FN: 58
------------------------------
食物:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 1
------------------------------
食物分组:
  精确率: 0.6429
  召回率: 0.6923
  F1值: 0.6667
  TP: 18, FP: 10, FN: 8
------------------------------
微平均:
  精确率: 0.8720
  召回率: 0.9040
  F1值: 0.8877
------------------------------
宏平均:
  精确率: 0.5980
  召回率: 0.6523
  F1值: 0.6211
==================================================
早停，最佳F1值: 0.8916
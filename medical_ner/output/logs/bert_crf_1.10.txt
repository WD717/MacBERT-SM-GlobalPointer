中文医疗实体识别模型
模型名称: bert_crf
设备: cpu

1. 数据准备
数据已划分完成

2. 开始训练模型
2026-01-10 11:02:01.875088: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2026-01-10 11:02:04.024800: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.

Epoch 1/10
--------------------------------------------------
训练: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [33:48<00:00,  5.07s/it] 
训练损失: 61.1081
评估: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:50<00:00,  2.03s/it]
实体识别评估指标
==================================================
中药功效:
  精确率: 0.7843
  召回率: 0.8511
  F1值: 0.8163
  TP: 280, FP: 77, FN: 49
------------------------------
人群:
  精确率: 0.6992
  召回率: 0.8431
  F1值: 0.7644
  TP: 86, FP: 37, FN: 16
------------------------------
疾病:
  精确率: 0.3976
  召回率: 0.5238
  F1值: 0.4521
  TP: 33, FP: 50, FN: 30
------------------------------
疾病分组:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 22
------------------------------
症状:
  精确率: 0.7237
  召回率: 0.8179
  F1值: 0.7679
  TP: 503, FP: 192, FN: 112
------------------------------
药品:
  精确率: 0.9351
  召回率: 0.9664
  F1值: 0.9505
  TP: 288, FP: 20, FN: 10
------------------------------
药品分组:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 1
------------------------------
药物剂型:
  精确率: 0.6692
  召回率: 0.8091
  F1值: 0.7325
  TP: 89, FP: 44, FN: 21
------------------------------
药物性味:
  精确率: 0.8250
  召回率: 0.9103
  F1值: 0.8656
  TP: 132, FP: 28, FN: 13
------------------------------
药物成分:
  精确率: 0.9792
  召回率: 0.9635
  F1值: 0.9713
  TP: 1982, FP: 42, FN: 75
------------------------------
证候:
  精确率: 0.4976
  召回率: 0.6456
  F1值: 0.5620
  TP: 102, FP: 103, FN: 56
------------------------------
食物:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 1
------------------------------
食物分组:
  精确率: 0.7143
  召回率: 0.7692
  F1值: 0.7407
  TP: 20, FP: 8, FN: 6
------------------------------
微平均:
  精确率: 0.8540
  召回率: 0.8951
  F1值: 0.8741
------------------------------
宏平均:
  精确率: 0.5558
  召回率: 0.6231
  F1值: 0.5864
==================================================
保存最佳模型到 C:\Users\Lenovo\Desktop\AAA研究生存档\课程学习\自然语言处理\code\medical_ner\output\models\bert_crf_best_model.pt

Epoch 2/10
--------------------------------------------------
训练: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [33:23<00:00,  5.01s/it] 
训练损失: 26.1169
评估: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:49<00:00,  1.97s/it] 
实体识别评估指标
==================================================
中药功效:
  精确率: 0.8374
  召回率: 0.8298
  F1值: 0.8336
  TP: 273, FP: 53, FN: 56
------------------------------
人群:
  精确率: 0.7544
  召回率: 0.8431
  F1值: 0.7963
  TP: 86, FP: 28, FN: 16
------------------------------
疾病:
  精确率: 0.3562
  召回率: 0.4127
  F1值: 0.3824
  TP: 26, FP: 47, FN: 37
------------------------------
疾病分组:
  精确率: 0.2500
  召回率: 0.3182
  F1值: 0.2800
  TP: 7, FP: 21, FN: 15
------------------------------
症状:
  精确率: 0.7463
  召回率: 0.7463
  F1值: 0.7463
  TP: 459, FP: 156, FN: 156
------------------------------
药品:
  精确率: 0.9253
  召回率: 0.9564
  F1值: 0.9406
  TP: 285, FP: 23, FN: 13
------------------------------
药品分组:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 1
------------------------------
药物剂型:
  精确率: 0.6340
  召回率: 0.8818
  F1值: 0.7376
  TP: 97, FP: 56, FN: 13
------------------------------
药物性味:
  精确率: 0.8562
  召回率: 0.8621
  F1值: 0.8591
  TP: 125, FP: 21, FN: 20
------------------------------
药物成分:
  精确率: 0.9736
  召回率: 0.9689
  F1值: 0.9712
  TP: 1993, FP: 54, FN: 64
------------------------------
证候:
  精确率: 0.5045
  召回率: 0.7025
  F1值: 0.5873
  TP: 111, FP: 109, FN: 47
------------------------------
食物:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 1
------------------------------
食物分组:
  精确率: 0.7407
  召回率: 0.7692
  F1值: 0.7547
  TP: 20, FP: 7, FN: 6
------------------------------
微平均:
  精确率: 0.8583
  召回率: 0.8867
  F1值: 0.8722
------------------------------
宏平均:
  精确率: 0.5830
  召回率: 0.6378
  F1值: 0.6069
==================================================

Epoch 3/10
--------------------------------------------------
训练: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [32:41<00:00,  4.90s/it] 
训练损失: 21.8885
评估: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:51<00:00,  2.04s/it]
实体识别评估指标
==================================================
中药功效:
  精确率: 0.7948
  召回率: 0.8359
  F1值: 0.8148
  TP: 275, FP: 71, FN: 54
------------------------------
人群:
  精确率: 0.7417
  召回率: 0.8725
  F1值: 0.8018
  TP: 89, FP: 31, FN: 13
------------------------------
疾病:
  精确率: 0.4253
  召回率: 0.5873
  F1值: 0.4933
  TP: 37, FP: 50, FN: 26
------------------------------
疾病分组:
  精确率: 0.4286
  召回率: 0.2727
  F1值: 0.3333
  TP: 6, FP: 8, FN: 16
------------------------------
症状:
  精确率: 0.7630
  召回率: 0.7854
  F1值: 0.7740
  TP: 483, FP: 150, FN: 132
------------------------------
药品:
  精确率: 0.9290
  召回率: 0.9664
  F1值: 0.9474
  TP: 288, FP: 22, FN: 10
------------------------------
药品分组:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 1
------------------------------
药物剂型:
  精确率: 0.6287
  召回率: 0.9545
  F1值: 0.7581
  TP: 105, FP: 62, FN: 5
------------------------------
药物性味:
  精确率: 0.8707
  召回率: 0.8828
  F1值: 0.8767
  TP: 128, FP: 19, FN: 17
------------------------------
药物成分:
  精确率: 0.9731
  召回率: 0.9665
  F1值: 0.9698
  TP: 1988, FP: 55, FN: 69
------------------------------
证候:
  精确率: 0.6319
  召回率: 0.6519
  F1值: 0.6417
  TP: 103, FP: 60, FN: 55
------------------------------
食物:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 1
------------------------------
食物分组:
  精确率: 0.7407
  召回率: 0.7692
  F1值: 0.7547
  TP: 20, FP: 7, FN: 6
------------------------------
微平均:
  精确率: 0.8681
  召回率: 0.8969
  F1值: 0.8823
------------------------------
宏平均:
  精确率: 0.6098
  召回率: 0.6573
  F1值: 0.6281
==================================================
保存最佳模型到 C:\Users\Lenovo\Desktop\AAA研究生存档\课程学习\自然语言处理\code\medical_ner\output\models\bert_crf_best_model.pt

Epoch 4/10
--------------------------------------------------
训练: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [32:26<00:00,  4.87s/it] 
训练损失: 18.8682
评估: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:48<00:00,  1.94s/it] 
实体识别评估指标
==================================================
中药功效:
  精确率: 0.8359
  召回率: 0.8207
  F1值: 0.8282
  TP: 270, FP: 53, FN: 59
------------------------------
人群:
  精确率: 0.7355
  召回率: 0.8725
  F1值: 0.7982
  TP: 89, FP: 32, FN: 13
------------------------------
疾病:
  精确率: 0.4239
  召回率: 0.6190
  F1值: 0.5032
  TP: 39, FP: 53, FN: 24
------------------------------
疾病分组:
  精确率: 0.3043
  召回率: 0.3182
  F1值: 0.3111
  TP: 7, FP: 16, FN: 15
------------------------------
症状:
  精确率: 0.7270
  召回率: 0.8228
  F1值: 0.7719
  TP: 506, FP: 190, FN: 109
------------------------------
药品:
  精确率: 0.9444
  召回率: 0.9698
  F1值: 0.9570
  TP: 289, FP: 17, FN: 9
------------------------------
药品分组:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 1
------------------------------
药物剂型:
  精确率: 0.6474
  召回率: 0.9182
  F1值: 0.7594
  TP: 101, FP: 55, FN: 9
------------------------------
药物性味:
  精确率: 0.8904
  召回率: 0.8966
  F1值: 0.8935
  TP: 130, FP: 16, FN: 15
------------------------------
药物成分:
  精确率: 0.9722
  召回率: 0.9849
  F1值: 0.9785
  TP: 2026, FP: 58, FN: 31
------------------------------
证候:
  精确率: 0.6000
  召回率: 0.6076
  F1值: 0.6038
  TP: 96, FP: 64, FN: 62
------------------------------
食物:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 1
------------------------------
食物分组:
  精确率: 0.7778
  召回率: 0.8077
  F1值: 0.7925
  TP: 21, FP: 6, FN: 5
------------------------------
微平均:
  精确率: 0.8645
  召回率: 0.9101
  F1值: 0.8867
------------------------------
宏平均:
  精确率: 0.6045
  召回率: 0.6645
  F1值: 0.6306
==================================================
保存最佳模型到 C:\Users\Lenovo\Desktop\AAA研究生存档\课程学习\自然语言处理\code\medical_ner\output\models\bert_crf_best_model.pt

Epoch 5/10
--------------------------------------------------
训练: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [32:00<00:00,  4.80s/it] 
训练损失: 16.4646
评估: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:48<00:00,  1.93s/it] 
实体识别评估指标
==================================================
中药功效:
  精确率: 0.8513
  召回率: 0.8176
  F1值: 0.8341
  TP: 269, FP: 47, FN: 60
------------------------------
人群:
  精确率: 0.7200
  召回率: 0.8824
  F1值: 0.7930
  TP: 90, FP: 35, FN: 12
------------------------------
疾病:
  精确率: 0.4286
  召回率: 0.7143
  F1值: 0.5357
  TP: 45, FP: 60, FN: 18
------------------------------
疾病分组:
  精确率: 0.3810
  召回率: 0.3636
  F1值: 0.3721
  TP: 8, FP: 13, FN: 14
------------------------------
症状:
  精确率: 0.7504
  召回率: 0.8114
  F1值: 0.7797
  TP: 499, FP: 166, FN: 116
------------------------------
药品:
  精确率: 0.9600
  召回率: 0.9664
  F1值: 0.9632
  TP: 288, FP: 12, FN: 10
------------------------------
药品分组:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 1
------------------------------
药物剂型:
  精确率: 0.6757
  召回率: 0.9091
  F1值: 0.7752
  TP: 100, FP: 48, FN: 10
------------------------------
药物性味:
  精确率: 0.8725
  召回率: 0.8966
  F1值: 0.8844
  TP: 130, FP: 19, FN: 15
------------------------------
药物成分:
  精确率: 0.9752
  召回率: 0.9762
  F1值: 0.9757
  TP: 2008, FP: 51, FN: 49
------------------------------
证候:
  精确率: 0.6071
  召回率: 0.6456
  F1值: 0.6258
  TP: 102, FP: 66, FN: 56
------------------------------
食物:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 1
------------------------------
食物分组:
  精确率: 0.7407
  召回率: 0.7692
  F1值: 0.7547
  TP: 20, FP: 7, FN: 6
------------------------------
微平均:
  精确率: 0.8717
  召回率: 0.9063
  F1值: 0.8886
------------------------------
宏平均:
  精确率: 0.6125
  召回率: 0.6733
  F1值: 0.6380
==================================================
保存最佳模型到 C:\Users\Lenovo\Desktop\AAA研究生存档\课程学习\自然语言处理\code\medical_ner\output\models\bert_crf_best_model.pt

Epoch 6/10
--------------------------------------------------
训练: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [32:13<00:00,  4.83s/it] 
训练损失: 14.5720
评估: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:48<00:00,  1.93s/it] 
实体识别评估指标
==================================================
中药功效:
  精确率: 0.8313
  召回率: 0.8389
  F1值: 0.8351
  TP: 276, FP: 56, FN: 53
------------------------------
人群:
  精确率: 0.7273
  召回率: 0.8627
  F1值: 0.7892
  TP: 88, FP: 33, FN: 14
------------------------------
疾病:
  精确率: 0.4112
  召回率: 0.6984
  F1值: 0.5176
  TP: 44, FP: 63, FN: 19
------------------------------
疾病分组:
  精确率: 0.2353
  召回率: 0.3636
  F1值: 0.2857
  TP: 8, FP: 26, FN: 14
------------------------------
症状:
  精确率: 0.7542
  召回率: 0.7984
  F1值: 0.7757
  TP: 491, FP: 160, FN: 124
------------------------------
药品:
  精确率: 0.9346
  召回率: 0.9597
  F1值: 0.9470
  TP: 286, FP: 20, FN: 12
------------------------------
药品分组:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 3, FN: 1
------------------------------
药物剂型:
  精确率: 0.6897
  召回率: 0.9091
  F1值: 0.7843
  TP: 100, FP: 45, FN: 10
------------------------------
药物性味:
  精确率: 0.8533
  召回率: 0.8828
  F1值: 0.8678
  TP: 128, FP: 22, FN: 17
------------------------------
药物成分:
  精确率: 0.9673
  召回率: 0.9767
  F1值: 0.9719
  TP: 2009, FP: 68, FN: 48
------------------------------
证候:
  精确率: 0.5593
  召回率: 0.6266
  F1值: 0.5910
  TP: 99, FP: 78, FN: 59
------------------------------
食物:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 1
------------------------------
食物分组:
  精确率: 0.7037
  召回率: 0.7308
  F1值: 0.7170
  TP: 19, FP: 8, FN: 7
------------------------------
微平均:
  精确率: 0.8591
  召回率: 0.9035
  F1值: 0.8807
  F1值: 0.5910
  TP: 99, FP: 78, FN: 59
------------------------------
食物:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 1
------------------------------
食物分组:
  精确率: 0.7037
  召回率: 0.7308
  F1值: 0.7170
  TP: 19, FP: 8, FN: 7
------------------------------
微平均:
  精确率: 0.8591
  召回率: 0.9035
  F1值: 0.8807
  F1值: 0.0000
  TP: 0, FP: 0, FN: 1
------------------------------
食物分组:
  精确率: 0.7037
  召回率: 0.7308
  F1值: 0.7170
  TP: 19, FP: 8, FN: 7
------------------------------
微平均:
  精确率: 0.8591
  召回率: 0.9035
  F1值: 0.8807
食物分组:
  精确率: 0.7037
  召回率: 0.7308
  F1值: 0.7170
  TP: 19, FP: 8, FN: 7
------------------------------
微平均:
  精确率: 0.8591
  召回率: 0.9035
  F1值: 0.8807
  F1值: 0.7170
  TP: 19, FP: 8, FN: 7
------------------------------
微平均:
  精确率: 0.8591
  召回率: 0.9035
  F1值: 0.8807
------------------------------
宏平均:
微平均:
  精确率: 0.8591
  召回率: 0.9035
  F1值: 0.8807
------------------------------
宏平均:
  召回率: 0.9035
  F1值: 0.8807
------------------------------
宏平均:
  精确率: 0.5898
------------------------------
宏平均:
  精确率: 0.5898
  精确率: 0.5898
  召回率: 0.6652
  召回率: 0.6652
  F1值: 0.6217
==================================================

Epoch 7/10
--------------------------------------------------
训练: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [32:53<00:00,  4.93s/it] 
训练损失: 13.2011
评估: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:48<00:00,  1.93s/it]
实体识别评估指标
==================================================
中药功效:
  精确率: 0.8404
  召回率: 0.8480
  F1值: 0.8442
  TP: 279, FP: 53, FN: 50
------------------------------
人群:
  精确率: 0.7213
  召回率: 0.8627
  F1值: 0.7857
  TP: 88, FP: 34, FN: 14
------------------------------
疾病:
  精确率: 0.3838
  召回率: 0.6032
  F1值: 0.4691
  TP: 38, FP: 61, FN: 25
------------------------------
疾病分组:
  精确率: 0.2353
  召回率: 0.3636
  F1值: 0.2857
  TP: 8, FP: 26, FN: 14
------------------------------
症状:
  精确率: 0.7500
  召回率: 0.8098
  F1值: 0.7787
  TP: 498, FP: 166, FN: 117
------------------------------
药品:
  精确率: 0.9444
  召回率: 0.9698
  F1值: 0.9570
  TP: 289, FP: 17, FN: 9
------------------------------
药品分组:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 1
------------------------------
药物剂型:
  精确率: 0.6528
  召回率: 0.8545
  F1值: 0.7402
  TP: 94, FP: 50, FN: 16
------------------------------
药物性味:
  精确率: 0.8658
  召回率: 0.8897
  F1值: 0.8776
  TP: 129, FP: 20, FN: 16
------------------------------
药物成分:
  精确率: 0.9777
  召回率: 0.9825
  F1值: 0.9801
  TP: 2021, FP: 46, FN: 36
------------------------------
证候:
  精确率: 0.6023
  召回率: 0.6519
  F1值: 0.6261
  TP: 103, FP: 68, FN: 55
------------------------------
食物:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 1
------------------------------
食物分组:
  精确率: 0.6296
  召回率: 0.6538
  F1值: 0.6415
  TP: 17, FP: 10, FN: 9
------------------------------
微平均:
  精确率: 0.8661
  召回率: 0.9076
  F1值: 0.8863
------------------------------
宏平均:
  精确率: 0.5849
  召回率: 0.6530
  F1值: 0.6143
==================================================

Epoch 8/10
--------------------------------------------------
训练: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 400/400 [33:14<00:00,  4.99s/it] 
训练损失: 11.8492
评估: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:59<00:00,  2.37s/it]
实体识别评估指标
==================================================
中药功效:
  精确率: 0.8393
  召回率: 0.8571
  F1值: 0.8481
  TP: 282, FP: 54, FN: 47
------------------------------
人群:
  精确率: 0.7317
  召回率: 0.8824
  F1值: 0.8000
  TP: 90, FP: 33, FN: 12
------------------------------
疾病:
  精确率: 0.4141
  召回率: 0.6508
  F1值: 0.5062
  TP: 41, FP: 58, FN: 22
------------------------------
疾病分组:
  精确率: 0.2857
  召回率: 0.3636
  F1值: 0.3200
  TP: 8, FP: 20, FN: 14
------------------------------
症状:
  精确率: 0.7511
  召回率: 0.8195
  F1值: 0.7838
  TP: 504, FP: 167, FN: 111
------------------------------
药品:
  精确率: 0.9416
  召回率: 0.9732
  F1值: 0.9571
  TP: 290, FP: 18, FN: 8
------------------------------
药品分组:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 1
------------------------------
药物剂型:
  精确率: 0.6538
  召回率: 0.9273
  F1值: 0.7669
  TP: 102, FP: 54, FN: 8
------------------------------
药物性味:
  精确率: 0.8609
  召回率: 0.8966
  F1值: 0.8784
  TP: 130, FP: 21, FN: 15
------------------------------
药物成分:
  精确率: 0.9777
  召回率: 0.9820
  F1值: 0.9799
  TP: 2020, FP: 46, FN: 37
------------------------------
证候:
  精确率: 0.5682
  召回率: 0.6329
  F1值: 0.5988
  TP: 100, FP: 76, FN: 58
------------------------------
食物:
  精确率: 0.0000
  召回率: 0.0000
  F1值: 0.0000
  TP: 0, FP: 0, FN: 1
------------------------------
食物分组:
  精确率: 0.6296
  召回率: 0.6538
  F1值: 0.6415
  TP: 17, FP: 10, FN: 9
------------------------------
微平均:
  精确率: 0.8655
  召回率: 0.9127
  F1值: 0.8884
------------------------------
宏平均:
  精确率: 0.5888
  召回率: 0.6646
  F1值: 0.6216
==================================================
早停，最佳F1值: 0.8886